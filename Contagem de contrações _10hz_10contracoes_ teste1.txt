10 contrações - ótimo

//Parâmetros
long frequencia = 10;             //frequência de aquisição do sinal, neste caso, 1000 sinais por segundo
float fator1 = 0.30, fator2 = 0.22; //parâmetros de médias móveis
float incerteza = 60;             //Para cálculo de  cruzamento
float pico_basal = 130;           // Mínimo para ser considerado um pico de contração
unsigned long filtro_horizontal = 1500000UL;

Biceps_D,mediaMovel_1,mediaMovel_2,Contracao
382,114.60,84.04,0
423,207.12,158.61,0
408,267.38,213.48,0
395,305.67,253.41,0
385,329.47,282.36,0
321,326.93,290.86,0
363,337.75,306.73,0
306,328.22,306.57,0
349,334.46,315.91,0
342,336.72,321.65,0
336,336.50,324.80,0
339,337.25,327.93,0
276,318.88,316.50,0
273,305.11,306.93,0
270,294.58,298.81,0
268,286.61,292.03,0
267,280.72,286.52,0
264,275.71,281.57,0
261,271.29,277.04,0
262,268.51,273.73,0
257,265.05,270.05,0
257,262.64,267.18,0
254,260.05,264.28,0
253,257.93,261.80,0
240,252.55,257.00,0
237,247.89,252.60,0
298,262.92,262.59,0
299,273.74,270.60,0
296,280.42,276.19,0
293,284.19,279.89,0
291,286.24,282.33,0
291,287.67,284.24,0
290,288.37,285.51,0
291,289.16,286.71,0
287,288.51,286.78,0
288,288.36,287.05,0
288,288.25,287.26,0
289,288.47,287.64,0
287,288.03,287.50,0
286,287.42,287.17,0
288,287.60,287.35,0
286,287.12,287.05,0
285,286.48,286.60,0
287,286.64,286.69,0
285,286.15,286.32,0
285,285.80,286.03,0
286,285.86,286.02,0
284,285.30,285.58,0
285,285.21,285.45,0
281,283.95,284.47,0
281,283.06,283.71,0
295,286.64,286.19,0
303,291.55,289.89,0
322,300.69,296.95,0
357,317.58,310.16,0
345,325.81,317.83,0
450,363.06,346.91,0
442,386.75,367.83,0
500,420.72,396.90,1
607,476.61,443.13,1
644,526.82,487.32,1
609,551.48,514.09,1
585,561.53,529.69,1
567,563.17,537.90,1
542,556.82,538.80,1
522,546.38,535.10,1
498,531.86,526.94,1
473,514.20,515.07,1
450,494.94,500.76,1
485,491.96,497.29,1
410,467.37,478.09,1
448,461.56,471.47,1
427,451.19,461.68,1
357,422.93,438.65,1
396,414.85,429.27,1
332,390.00,407.87,1
324,370.20,389.42,1
367,369.24,384.49,1
358,365.87,378.66,1
351,361.41,372.57,1
343,355.88,366.07,1
343,352.02,360.99,1
298,335.81,347.13,1
374,347.27,353.05,1
379,356.79,358.76,1
393,367.65,366.29,1
427,385.46,379.65,1
471,411.12,399.74,1
515,442.28,425.10,1
567,479.70,456.32,2
613,519.69,490.79,2
657,560.88,527.35,2
643,585.52,552.80,2
637,600.96,571.32,2
677,623.77,594.57,2
651,631.94,606.98,2
625,629.86,610.95,2
534,601.10,594.02,2
572,592.37,589.18,2
484,559.86,566.04,2
462,530.50,543.15,2
440,503.35,520.46,2
423,479.25,499.02,2
403,456.37,477.89,2
443,452.36,470.22,2
372,428.25,448.61,2
361,408.08,429.33,2
347,389.75,411.22,2
335,373.33,394.45,2
324,358.53,378.95,2
314,345.17,364.66,2
306,333.42,351.76,2
298,322.79,339.93,2
342,328.56,340.39,2
289,316.69,329.08,2
298,311.08,322.24,2
311,311.06,319.77,2
331,317.04,322.24,2
414,346.13,342.43,2
377,355.39,350.03,2
453,384.67,372.69,2
504,420.47,401.58,2
484,439.53,419.71,2
570,478.67,452.77,3
543,497.97,472.62,3
628,536.98,506.81,3
551,541.19,516.53,3
529,537.53,519.27,3
575,548.77,531.53,3
558,551.54,537.36,3
543,548.98,538.60,3
523,541.18,535.17,3
498,528.23,526.99,3
418,495.16,503.01,3
400,466.61,480.35,3
436,457.43,470.59,3
360,428.20,446.26,3
396,418.54,435.20,3
326,390.78,411.18,3
365,383.04,401.02,3
352,373.73,390.24,3
340,363.61,379.18,3
275,337.03,356.26,3
319,331.62,348.07,3
259,309.83,328.47,3
301,307.18,322.43,3
247,289.13,305.83,3
251,277.69,293.77,3
265,273.88,287.44,3
283,276.62,286.46,3
299,283.33,289.22,3
326,296.13,297.31,3
398,326.69,319.46,3
383,343.59,333.44,3
448,374.91,358.64,3
490,409.44,387.54,4
537,447.71,420.42,4
561,481.69,451.35,4
592,514.79,482.29,4
572,531.95,502.03,4
547,536.47,511.92,4
520,531.53,513.70,4
499,521.77,510.47,4
474,507.44,502.44,4
448,489.61,490.47,4
482,487.32,488.60,4
400,461.13,469.11,4
435,453.29,461.61,4
353,423.20,437.71,4
342,398.84,416.66,4
383,394.09,409.25,4
364,385.06,399.30,4
350,374.54,388.45,4
286,347.98,365.91,4
328,341.99,357.57,4
317,334.49,348.65,4
247,308.24,326.28,4
307,307.87,322.04,4
312,309.11,319.83,4
326,314.18,321.19,4
342,322.52,325.77,4
357,332.87,332.64,4
370,344.01,340.86,4
405,362.30,354.97,4
397,372.71,364.22,4
500,410.90,394.09,4
555,454.13,429.49,5
598,497.29,466.56,5
653,544.00,507.58,5
599,560.50,527.69,5
566,562.15,536.12,5
542,556.11,537.41,5
519,544.97,533.36,5
560,549.48,539.22,5
476,527.44,525.31,5
448,503.61,508.30,5
426,480.32,490.20,5
403,457.13,471.01,5
385,435.49,452.09,5
365,414.34,432.93,5
347,394.14,414.03,5
332,375.50,395.98,5
318,358.25,378.82,5
302,341.37,361.92,5
289,325.66,345.88,5
280,311.96,331.39,5
318,313.77,328.44,5
257,296.74,312.72,5
251,283.02,299.14,5
246,271.91,287.45,5
248,264.74,278.77,5
248,259.72,272.00,5
332,281.40,285.20,5
307,289.08,290.00,5
387,318.46,311.34,5
356,329.72,321.16,5
457,367.90,351.05,5
514,411.73,386.90,6
498,437.61,411.34,6
596,485.13,451.97,6
627,527.69,490.47,6
628,557.78,520.73,6
601,570.75,538.39,6
572,571.12,545.78,6
550,564.79,546.71,6
527,553.45,542.37,6
504,538.62,533.93,6
477,520.13,521.41,6
455,500.59,506.80,6
435,480.91,491.00,6
360,444.64,462.18,6
399,430.95,448.28,6
387,417.76,434.80,6
366,402.23,419.66,6
351,386.86,404.56,6
286,356.60,378.47,6
276,332.42,355.93,6
315,327.20,346.93,6
257,306.14,327.14,6
250,289.30,310.17,6
293,290.41,306.39,6
244,276.49,292.67,6
246,267.34,282.40,6
260,265.14,277.47,6
287,271.70,279.57,6
311,283.49,286.48,6
362,307.04,303.10,6
410,337.93,326.62,6
444,369.75,352.44,6
501,409.13,385.12,7
551,451.69,421.62,7
566,485.98,453.38,7
573,512.09,479.70,7
616,543.26,509.68,7
524,537.48,512.83,7
499,525.94,509.79,7
470,509.16,501.04,7
445,489.91,488.71,7
425,470.44,474.69,7
462,467.91,471.90,7
437,458.63,464.22,7
417,446.14,453.83,7
397,431.40,441.33,7
320,397.98,414.64,7
314,372.79,392.50,7
351,366.25,383.37,7
336,357.18,372.95,7
324,347.22,362.18,7
313,336.96,351.36,7
304,327.07,340.94,7
249,303.65,320.71,7
294,300.75,314.84,7
292,298.13,309.81,7
293,296.59,306.11,7
310,300.61,306.97,7
333,310.33,312.70,7
368,327.63,324.86,7
361,337.64,332.81,7
462,374.95,361.23,7
509,415.16,393.74,8
484,435.81,413.60,8
580,479.07,450.21,8
528,493.75,467.32,8
570,516.62,489.91,8
546,525.44,502.25,8
524,525.01,507.04,8
445,501.00,493.39,8
479,494.40,490.22,8
400,466.08,470.37,8
382,440.86,450.93,8
363,417.50,431.59,8
346,396.05,412.76,8
323,374.14,393.01,8
315,356.39,375.85,8
301,339.78,359.38,8
287,323.94,343.46,8
278,310.16,329.06,8
314,311.31,325.74,8
253,293.82,309.74,8
249,280.37,296.38,8
241,268.56,284.19,8
239,259.69,274.25,8
242,254.38,267.16,8
299,267.77,274.16,8
315,281.94,283.15,8
325,294.86,292.35,8
349,311.10,304.82,8
336,318.57,311.68,8
440,355.00,339.91,8
494,396.70,373.81,9
538,439.09,409.93,9
595,485.86,450.65,9
634,530.30,490.98,9
626,559.01,520.69,9
597,570.41,537.48,9
570,570.29,544.63,9
548,563.60,545.37,9
520,550.52,539.79,9
497,534.46,530.38,9
415,498.62,504.99,9
396,467.84,481.02,9
431,456.79,470.01,9
359,427.45,445.59,9
339,400.92,422.14,9
381,394.94,413.09,9
361,384.76,401.63,9
298,358.73,378.83,9
334,351.31,368.97,9
323,342.82,358.86,9
312,333.57,348.55,9
302,324.10,338.31,9
252,302.47,319.32,9
259,289.43,306.05,9
275,285.10,299.22,9
302,290.17,299.83,9
323,300.02,304.93,9
360,318.01,317.04,9
401,342.91,335.51,9
448,374.44,360.26,9
490,409.11,388.80,9
586,462.17,432.19,10
567,493.62,461.85,10
599,525.24,492.02,10
583,542.56,512.04,10
555,546.30,521.49,10
529,541.11,523.14,10
503,529.67,518.71,10
537,531.87,522.73,10
442,504.91,504.97,10
475,495.94,498.38,10
450,482.16,487.73,10
377,450.61,463.37,10
365,424.93,441.73,10
431,426.75,439.37,10
452,434.32,442.15,10
506,455.83,456.20,10
549,483.78,476.61,10
581,512.95,499.58,10
619,544.76,525.85,10